pretty = proc(u) {
  return ~(floor(u*1000)/1000);
};

prec = 500;

//bessel_i0 = library("./notes/bessel_sollya/cmake-build-release/libbessel_sollya.dylib");

//f = 2.70265284158458111246639178380860921965281806355772639932174388328913237632303651273240661304359005444739555445283608842518250882276959e-126*y^48 + 6.48906947264457925103180667292447073638641617060210108477150706377720683555161066707050827791765972072819672624125944830886320368346979e-123*y^47 + 1.49508160649731105943772825744179805766343028570672408993135522749426845491109109769304510723222879965577652572598617689036208212867144e-119*y^46 + 3.30263526875256013029794172068893190937851750112615351465836369753483901689860023480393664187599341843961034532870346475080983942223518e-116*y^45 + 6.98837622868041723571044468097777992024494303238294083701709758398371935975743809684512993420960207341821549071553653141271362021744968e-113*y^44 + 1.41514618630778449023136504789800043384960096405754551949596226075670317035088121461113881167744441986718863686989614761107450809403358e-109*y^43 + 2.73972301669187077308792273273052883993282746641540812574418293682497733779930603148716473940753239686287720098011894177504024767004897e-106*y^42 + 5.06574785786326905943956913281874782503579798540208962450099425018938309759091685221976760316452740179945994461223992334204941794192055e-103*y^41 + 8.93597922127080662085139995029227116336314764624928609761975385733407178415037732731567005198222633677424734229599122477537517324954770e-100*y^40 + 1.50213810709562259296512033164413078256134511933450499300988062341785746691567842872176413573821224721175097823995612488474056662324896e-96*y^39 + 2.40342097135299614874419253063060925209815219093520798881580899746857194706508548595482261718113959553880156518392979981558490659719840e-93*y^38 + 3.65560329742790714223991683908915667244128948241245135098884548514969793148599502413728520073251332481451718064475722551950464293433873e-90*y^37 + 5.27869116148589791339443991564474223500522201260357975082789288055616381306577681485423982985774924103216280885102943365016470439718507e-87*y^36 + 7.22652820007419424343698824451765211972214893525430067888338535348138826008704845953545432707525871097303088531705929466707548031974669e-84*y^35 + 9.36558054729615573949433676489487714715990502008957367983286741811187918507281480355794880788953528942104802737090884588852982249439148e-81*y^34 + 1.14728361704377907808805625369962245052708836496097277577952625871870520017141981343584872896646807295407838335293633362134490325556295e-77*y^33 + 1.32625986130260861426979302927676355280931414989488452880113235507882321139816130433184113068523709233491461115599440166627470816343076e-74*y^32 + 1.44429698895854078093980460888239550900934310923552925186443313468083847721259766041737499131622319355272201154887790341457315718997612e-71*y^31 + 1.47896011669354575968235991949557300122556734385718195390917952991317860066570000426739199110781255019798733982605097309652291296253552e-68*y^30 + 1.42128067214249747505474788263524565417777021744675185770672152824656463523973770410096370345460786074026583357283498514575851935699661e-65*y^29 + 1.27915260492824772754927309437172108875999319570207667193604937542190817171576393369086733310914707466623925021555148663118266742129699e-62*y^28 + 1.07576734074465633886893867236661743564715427758544648109821752472982477241295746823401942714479268979430720943127880025682462330131080e-59*y^27 + 8.43401595143810569673247919135428069547368953626990041181002539388182621571758655095471230881517468798736852194122579401350504668227650e-57*y^26 + 6.14839762859837905291797733049727062700031967194075740020950851213985131125812059564598527312626234754279165249515360383584517903137953e-54*y^25 + 4.15631679693250423977255267541615494385221609823195200254162775420653948641048952265668604463335334693892715708672383619303134102521257e-51*y^24 + 2.59769799808281514985784542213509683990763506139497000158851734637908717900655595166042877789584584183682947317920239762064458814075784e-48*y^23 + 1.49627404689570152631811896314981577978679779536350272091498599151435421510777622815640697606800720489801377655122058102949128276907652e-45*y^22 + 7.91528970807826107422284931506252547507216033747292939364027589511093379792013624694739290339975811391049287795595687364600888584841478e-43*y^21 + 3.83100021870987835992385906849026232993492560333689782652189353323369195819334594352253816524548292713267855293068312684466830075063274e-40*y^20 + 1.68947109645105635672642184920420568750130219107157194149615504815605815356326556109343933087325797086551124184243125893849872063102908e-37*y^19 + 6.75788438580422542690568739681682275000520876428628776598462019262423261425306224437375732349303188346204496736972503575399488252411625e-35*y^18 + 2.43959626327532537911295315025087301275188036390734988352044788953734797374535547021892639378098450992979823322047073790719215259120597e-32*y^17 + 7.90429189301205422832596820681282856131609237905981362260625116210100743493495172350932151585038981217254627563432519081930257439550724e-30*y^16 + 2.28434035708048367198620481176890745422035069754828613693320658584719114869620104809419391808076265571786587365831998014677844400030159e-27*y^15 + 5.84791131412603820028468431812840308280409778572361251054900885976880934066227468312113643028675239863773663656529914917575281664077211e-25*y^14 + 1.31578004567835859506405397157889069363092200178781281487352699344798210164901180370225569681451928969349074322719230856454438374417372e-22*y^13 + 2.57892888952958284632554578429462575951660712350411311715211290715804491923206313525642116575645780779924185672529692478650699213858047e-20*y^12 + 4.35838982330499501029017237545791753358306603872195116798707081309709591350218669858335177012841369518071873786575180288919681671420107e-18*y^11 + 6.27608134555919281481784822065940124835961509575960968190138197085981811544314884596002654898491572106023498252668259616044341606844937e-16*y^10 + 7.59405842812662330592959634699787551051513426586912771510067218474037991968621010361163212427174802248288432885728594135413653344282382e-14*y^9 + 7.59405842812662330592959634699787551051513426586912771510067218474037991968621010361163212427174802248288432885728594135413653344282398e-12*y^8 + 6.15118732678256487780297304106827916351725875535399344923154446963970773494583018392542202066011589821113630637440161249685059208868731e-10*y^7 + 3.93675988914084152179390274628369866465104560342655580750818846056941295036533131771227009322247417485512723607961703199798437893675991e-8*y^6 + 1.92901234567901234567901234567901234567901234567901234567901234567901234567901234567901234567901234567901234567901234567901234567901233e-6*y^5 + 0.0000694444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444447*y^4 + 0.00173611111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111112*y^3 + 0.0277777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777779*y^2 + 0.250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000*y + 1.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000;
f = 1.41514618630778449023136504789800043384960096405754551949596226075670317035088121461113881167744441986718863686989614761107450809403356362836400042839e-109*y^43 + 2.73972301669187077308792273273052883993282746641540812574418293682497733779930603148716473940753239686287720098011894177504024767004897918451270482937e-106*y^42 + 5.06574785786326905943956913281874782503579798540208962450099425018938309759091685221976760316452740179945994461223992334204941794192056251216399122950e-103*y^41 + 8.93597922127080662085139995029227116336314764624928609761975385733407178415037732731567005198222633677424734229599122477537517324954787227145728052886e-100*y^40 + 1.50213810709562259296512033164413078256134511933450499300988062341785746691567842872176413573821224721175097823995612488474056662324899732883196885690e-96*y^39 + 2.40342097135299614874419253063060925209815219093520798881580899746857194706508548595482261718113959553880156518392979981558490659719839572613115017104e-93*y^38 + 3.65560329742790714223991683908915667244128948241245135098884548514969793148599502413728520073251332481451718064475722551950464293433875989944547941015e-90*y^37 + 5.27869116148589791339443991564474223500522201260357975082789288055616381306577681485423982985774924103216280885102943365016470439718516929479927226826e-87*y^36 + 7.22652820007419424343698824451765211972214893525430067888338535348138826008704845953545432707525871097303088531705929466707548031974649676458020373523e-84*y^35 + 9.36558054729615573949433676489487714715990502008957367983286741811187918507281480355794880788953528942104802737090884588852982249439145980689594404087e-81*y^34 + 1.14728361704377907808805625369962245052708836496097277577952625871870520017141981343584872896646807295407838335293633362134490325556295382634475314501e-77*y^33 + 1.32625986130260861426979302927676355280931414989488452880113235507882321139816130433184113068523709233491461115599440166627470816343077462325453463563e-74*y^32 + 1.44429698895854078093980460888239550900934310923552925186443313468083847721259766041737499131622319355272201154887790341457315718997611356472418821820e-71*y^31 + 1.47896011669354575968235991949557300122556734385718195390917952991317860066570000426739199110781255019798733982605097309652291296253554029027756873543e-68*y^30 + 1.42128067214249747505474788263524565417777021744675185770672152824656463523973770410096370345460786074026583357283498514575851935699665421895674355475e-65*y^29 + 1.27915260492824772754927309437172108875999319570207667193604937542190817171576393369086733310914707466623925021555148663118266742129698879706106919928e-62*y^28 + 1.07576734074465633886893867236661743564715427758544648109821752472982477241295746823401942714479268979430720943127880025682462330131076757832835919659e-59*y^27 + 8.43401595143810569673247919135428069547368953626990041181002539388182621571758655095471230881517468798736852194122579401350504668227641781409433610129e-57*y^26 + 6.14839762859837905291797733049727062700031967194075740020950851213985131125812059564598527312626234754279165249515360383584517903137950858647477101784e-54*y^25 + 4.15631679693250423977255267541615494385221609823195200254162775420653948641048952265668604463335334693892715708672383619303134102521254780445694520806e-51*y^24 + 2.59769799808281514985784542213509683990763506139497000158851734637908717900655595166042877789584584183682947317920239762064458814075784237778559075504e-48*y^23 + 1.49627404689570152631811896314981577978679779536350272091498599151435421510777622815640697606800720489801377655122058102949128276907651720960450027490e-45*y^22 + 7.91528970807826107422284931506252547507216033747292939364027589511093379792013624694739290339975811391049287795595687364600888584841477603880780645424e-43*y^21 + 3.83100021870987835992385906849026232993492560333689782652189353323369195819334594352253816524548292713267855293068312684466830075063275160278297832385e-40*y^20 + 1.68947109645105635672642184920420568750130219107157194149615504815605815356326556109343933087325797086551124184243125893849872063102904345682729344081e-37*y^19 + 6.75788438580422542690568739681682275000520876428628776598462019262423261425306224437375732349303188346204496736972503575399488252411617382730917376327e-35*y^18 + 2.43959626327532537911295315025087301275188036390734988352044788953734797374535547021892639378098450992979823322047073790719215259120593875165861172854e-32*y^17 + 7.90429189301205422832596820681282856131609237905981362260625116210100743493495172350932151585038981217254627563432519081930257439550724155537390200047e-30*y^16 + 2.28434035708048367198620481176890745422035069754828613693320658584719114869620104809419391808076265571786587365831998014677844400030159280950305767814e-27*y^15 + 5.84791131412603820028468431812840308280409778572361251054900885976880934066227468312113643028675239863773663656529914917575281664077207759232782765602e-25*y^14 + 1.31578004567835859506405397157889069363092200178781281487352699344798210164901180370225569681451928969349074322719230856454438374417371745827376122261e-22*y^13 + 2.57892888952958284632554578429462575951660712350411311715211290715804491923206313525642116575645780779924185672529692478650699213858048621821657199631e-20*y^12 + 4.35838982330499501029017237545791753358306603872195116798707081309709591350218669858335177012841369518071873786575180288919681671420102170878600667376e-18*y^11 + 6.27608134555919281481784822065940124835961509575960968190138197085981811544314884596002654898491572106023498252668259616044341606844947126065184961022e-16*y^10 + 7.59405842812662330592959634699787551051513426586912771510067218474037991968621010361163212427174802248288432885728594135413653344282386022538873802836e-14*y^9 + 7.59405842812662330592959634699787551051513426586912771510067218474037991968621010361163212427174802248288432885728594135413653344282386022538873802837e-12*y^8 + 6.15118732678256487780297304106827916351725875535399344923154446963970773494583018392542202066011589821113630637440161249685059208868732678256487780298e-10*y^7 + 3.93675988914084152179390274628369866465104560342655580750818846056941295036533131771227009322247417485512723607961703199798437893675988914084152179391e-8*y^6 + 1.92901234567901234567901234567901234567901234567901234567901234567901234567901234567901234567901234567901234567901234567901234567901234567901234567901e-6*y^5 + 0.0000694444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444445*y^4 + 0.00173611111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111*y^3 + 0.0277777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777778*y^2 + 0.250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000*y + 1.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000;
d = [0, 3.6];
w = 1;
pf = fpminimax(f, 19, [|1, 127...|], d, relative, floating);

w = 1;
err_p = -log2(dirtyinfnorm(pf*w-f, d));
print ("relative error:", pretty(err_p));

for i from 0 to degree(pf) do {
    print("'", coeff(pf, i), "',");
};